
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë‚ ì§œ ê³„ì‚°ê¸° & ë°”ì½”ë“œ ìƒì„±ê¸°</title>
<style>
body {
  font-family: 'Pretendard', 'Arial', sans-serif;
  background: linear-gradient(120deg, #f0f4ff, #fefefe);
  margin: 0;
  padding: 0;
  text-align: center;
}
header {
  background-color: #3b82f6;
  color: white;
  padding: 15px 0;
  font-size: 1.4rem;
  font-weight: bold;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
nav {
  display: flex;
  justify-content: center;
  margin: 20px 0;
}
nav button {
  background-color: #e5e7eb;
  border: none;
  padding: 10px 20px;
  margin: 0 5px;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
}
nav button.active {
  background-color: #3b82f6;
  color: white;
}
.container {
  max-width: 480px;
  margin: 0 auto;
  background: white;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}
section {
  display: none;
}
section.active {
  display: block;
}
input, select, button, textarea {
  width: 100%;
  margin-top: 8px;
  padding: 10px;
  border-radius: 6px;
  border: 1px solid #d1d5db;
  font-size: 1rem;
}
button.action {
  background-color: #3b82f6;
  color: white;
  border: none;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
}
button.action:hover {
  background-color: #2563eb;
}
#preview-area {
  margin-top: 15px;
  padding: 10px;
  border: 1px dashed #ccc;
  border-radius: 8px;
  min-height: 150px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  color: #888;
}
img.preview {
  max-width: 100%;
  border-radius: 8px;
  margin-bottom: 10px;
}
.message {
  color: #ef4444;
  font-weight: bold;
  margin-top: 8px;
}
.barcode-result {
  margin-top: 10px;
  font-weight: bold;
  color: #16a34a;
}
</style>
</head>
<body>

<header>ë‚ ì§œ ê³„ì‚°ê¸° & ë°”ì½”ë“œ ìƒì„±ê¸°</header>
<nav>
  <button class="active" onclick="showTab('dateTab', this)">ë‚ ì§œ ê³„ì‚°ê¸°</button>
  <button onclick="showTab('barcodeTab', this)">ë°”ì½”ë“œ ìƒì„±ê¸°</button>
</nav>

<div class="container">
  <section id="dateTab" class="active">
    <h2>ğŸ“… ë‚ ì§œ ê³„ì‚°ê¸°</h2>
    <label>ê¸°ì¤€ ë‚ ì§œ ì„ íƒ:</label>
    <input type="date" id="base-date">
    <label>ë©°ì¹  í›„?</label>
    <input type="number" id="days" placeholder="ì˜ˆ: 45">
    <button class="action" onclick="calcDate()">ê³„ì‚°í•˜ê¸°</button>
    <div id="date-result"></div>
  </section>

  <section id="barcodeTab">
    <h2>ğŸ“· ë°”ì½”ë“œ ìƒì„±ê¸° & ì¸ì‹</h2>
    <input type="file" accept="image/*" id="barcode-image" onchange="previewImage(event)">
    <div id="preview-area">
      <span>ë¶ˆëŸ¬ì˜¨ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</span>
    </div>
    <button class="action" onclick="scanBarcode()">ë°”ì½”ë“œ ì¸ì‹</button>
    <div id="barcode-output" class="barcode-result"></div>
    <div id="barcode-message" class="message"></div>
    <button class="action" onclick="downloadBarcode()">ì €ì¥ëœ ë°”ì½”ë“œ ë‹¤ìš´ë¡œë“œ</button>
    <button class="action" onclick="clearBarcode()">ì €ì¥ëœ ë°”ì½”ë“œ ì‚­ì œ</button>
  </section>
</div>

<script src="https://unpkg.com/jsqr"></script>
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
<script>
function showTab(tabId, btn) {
  document.querySelectorAll('section').forEach(sec => sec.classList.remove('active'));
  document.getElementById(tabId).classList.add('active');
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

function calcDate() {
  const baseDate = document.getElementById('base-date').value;
  const days = parseInt(document.getElementById('days').value);
  if (!baseDate || isNaN(days)) return alert('ë‚ ì§œì™€ ì¼ìˆ˜ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.');
  const d = new Date(baseDate);
  d.setDate(d.getDate() + days);
  document.getElementById('date-result').innerText = `${days}ì¼ í›„ëŠ” ${d.getFullYear()}ë…„ ${d.getMonth()+1}ì›” ${d.getDate()}ì¼ì…ë‹ˆë‹¤.`;
}

function previewImage(event) {
  const file = event.target.files[0];
  const area = document.getElementById('preview-area');
  area.innerHTML = '';
  if (!file) {
    area.innerHTML = '<span>ë¶ˆëŸ¬ì˜¨ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</span>';
    return;
  }
  const img = document.createElement('img');
  img.className = 'preview';
  img.src = URL.createObjectURL(file);
  area.appendChild(img);
}

async function scanBarcode() {
  const imgEl = document.querySelector('#preview-area img');
  const output = document.getElementById('barcode-output');
  const msg = document.getElementById('barcode-message');
  msg.innerText = '';
  output.innerText = '';

  if (!imgEl) {
    msg.innerText = 'ë¶ˆëŸ¬ì˜¨ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.';
    return;
  }

  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = imgEl.naturalWidth;
  canvas.height = imgEl.naturalHeight;
  ctx.drawImage(imgEl, 0, 0);
  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);

  const code = jsQR(imageData.data, canvas.width, canvas.height);
  if (code) {
    output.innerText = `ì¸ì‹ëœ ì½”ë“œ: ${code.data}`;
    localStorage.setItem('barcodeData', code.data);
  } else {
    msg.innerText = 'ë°”ì½”ë“œ í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.';
  }
}

function downloadBarcode() {
  const data = localStorage.getItem('barcodeData');
  if (!data) return alert('ì €ì¥ëœ ë°”ì½”ë“œê°€ ì—†ìŠµë‹ˆë‹¤.');
  const blob = new Blob([data], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'barcode.txt';
  a.click();
}

function clearBarcode() {
  localStorage.removeItem('barcodeData');
  alert('ì €ì¥ëœ ë°”ì½”ë“œë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.');
}
</script>

</body>
</html>
